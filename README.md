# Интсрукция по запуску проекта

>[!NOTE]
>Версия языка программирования Python должна быть 3.9.4 и все последующие действия будут для Windows

1. Создаете папку с названием проекта (например rosatom)
2. Открываете эту папку в терминале:
Сначало нажимаете на клавищи Win+R, затем указываете путь к проекту через команду cd
Например:
```bash
cd C:\rosatom
```
3. Создаем виртуальную среду:
```bash
pip install virtualenv
python -m venv venv
```
4. Запускаем виртуальную среду:
```bash
venv\Scripts\activate
```
5. Теперь устанавливаем нужные библиотеки:

```bash
pip install -r requirements.txt
```

6. Скачиваем PostgreSQL и создаем новую БД:

Скачиваем PostgrSQL и устанваливаем.

Открываем SQLShell и вводим следующие команды
```bash
CREATE USER rosatom WITH PASSWORD '12345';
CREATE DATABASE rosatom OWNER rosatom ENCODING 'UTF8';
ALTER USER rosatom WITH SUPERUSER;
```

7. Далее:

Скачиваем все файлы из репазитория в zip формате и извлекаем в наш проект (то есть в rosatom). Затем в термнале вводим следующий код:
```bash
cd rosatom
```

8. Скачаиваем DockerDesktop:

Скачайте последнюю версию DockerDesktop и установите его.

Затем в терминале запустите эту команду:
```bash
docker-compose up --build
```
Далее откройте другой терминал и укажите этот же путь, с каторго запущен проект (например: C:\rosatom\rosatom). Затем в термнале вводим следующий код: 
```bash
docker-compose exec web python manage.py createsuperuser
```
Введите логин и пароль, которые в дальнейшем будете использовать, чтобы видеть, что находится в БД.

# Эта была инструкция по установке и запуску тестового проекта. Тепрерь покажу пример, как использовать веб-приложение

Для начало нужно скачать и установить Postman (так как все дальнейшие действия будут производится в Postman. Но это не обязательно, ведь можно и через браузер)

1. Регистрация пользователя
Метод: POST
URL: http://localhost:8000/api/register/

Настройки в Postman:

Перейдите на вкладку Body и выберите form-data.
Добавьте следующие ключи и значения:
username: имя пользователя (например, testuser)
password: пароль (например, password123)
email: адрес электронной почты (например, testuser@example.com)
Описание: Этот эндпоинт создаёт нового пользователя.

2. Получение JWT-токена для авторизации
Метод: POST
URL: http://localhost:8000/api/token/

Настройки в Postman:

Перейдите на вкладку Body и выберите form-data.
Добавьте следующие ключи и значения:
username: имя пользователя (например, testuser)
password: пароль (например, password123)
Описание: Этот эндпоинт возвращает access и refresh токены для аутентификации.

3. Обновление JWT-токена
Метод: POST
URL: http://localhost:8000/api/token/refresh/

Настройки в Postman:

Перейдите на вкладку Body и выберите form-data.
Добавьте следующий ключ и значение:
refresh: ваш refresh токен, полученный на шаге аутентификации.
Описание: Этот эндпоинт возвращает новый access токен, используя refresh токен.

4. Подключение к WebSocket для отправки сообщений
Для отправки сообщений и получения их в реальном времени используйте WebSocket-клиент Postman:

Введите URL WebSocket-соединения:

```bash
ws://localhost:8000/ws/chat/<channel_slug>/?token=<your_access_token>
```
<channel_slug>: замените на slug нужного канала (например, general).
<your_access_token>: вставьте access токен из шага аутентификации.
Отправьте JSON-сообщение. Пример сообщения:

```json
{
    "message": "Hello everyone!"
}
```
Описание: Это сообщение будет отправлено в канал и передано всем участникам, подключённым к этому каналу.

5. Просмотр истории сообщений канала
Метод: GET
URL: http://localhost:8000/api/channels/<channel_slug>/history/

Настройки в Postman:

Перейдите на вкладку Authorization и выберите Bearer Token.
Вставьте значение access токена.
Описание: Этот эндпоинт возвращает историю сообщений для указанного канала.

6. Блокировка/разблокировка пользователя (доступно только для модераторов)
Блокировка пользователя:

Метод: POST
URL: http://localhost:8000/api/channels/<channel_id>/block/<user_id>/
Разблокировка пользователя:

Метод: POST
URL: http://localhost:8000/api/channels/<channel_id>/unblock/<user_id>/
Настройки в Postman:

Перейдите на вкладку Authorization и выберите Bearer Token.
Вставьте access токен пользователя с ролью модератора.
Описание: Эти эндпоинты позволяют модератору блокировать или разблокировать пользователя в определённом канале.

# Запуск тестов внутри контейнера Docker
Убедитесь, что проект и база данных запущены через Docker Compose.


```bash
docker-compose exec web python manage.py test
```
Эта команда выполнит все тесты, определённые в проекте, и выведет результаты в консоль.

А это скрипт для создания тестовых данных
```bash
docker-compose exec web python manage.py create_test_data
```

Запомните, эти команды нужно вводить в другой консоли, ведь в начальной консоли проект должен буть в состоянии запуска.
